<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jean V. Adams" />

<meta name="date" content="2021-02-08" />

<title>Introduction to EchoNet2Fish</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to EchoNet2Fish</h1>
<h4 class="author">Jean V. Adams</h4>
<h4 class="date">2021-02-08</h4>



<p>The R package <strong>EchoNet2Fish</strong> estimates fish abundance from acoustic echoes and midwater trawl catch. At its core are functions that explore the data, <code>exploreACMT()</code> or <code>exploreACMT2()</code>, and generate the estimates, <code>estimateLake()</code>. The code is tailored to the format and procedures used by the Great Lakes Acoustic Users Group (Parker-Stetter et al. 2009).</p>
<div id="install" class="section level1">
<h1>Install</h1>
<p>Install the <strong>EchoNet2Fish</strong> package. If you don’t already have the <strong>devtools</strong> package installed, you can follow the instructions at <a href="https://github.com/JVAdams/EchoNet2Fish/blob/master/README.md">Readme</a> instead.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;JVAdams/EchoNet2Fish&quot;</span>)</span></code></pre></div>
<p>Then load the <strong>EchoNet2Fish</strong> package.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(EchoNet2Fish)</span></code></pre></div>
</div>
<div id="prepare-the-data" class="section level1">
<h1>Prepare the data</h1>
<p>Before any estimates are made, the acoustic and midwater trawl data must be prepared in the following way.</p>
<div id="file-organization" class="section level2">
<h2>File organization</h2>
<p>For each set of data for which you would like to generate estimates (e.g., for one year of data from one lake), you should have a single sub directory (<code>subdir</code>) containing all of the relevant files. For example, you might have a subdirectories called <em>H13</em>, <em>H14</em>, and <em>M14</em>, containing all of the data for Lake Huron in 2013 and 2014 and Lake Michigan in 2014. Within this subdirectory, you should have two more subdirectories for the acoustic data (one for all the Sv files and one for all the TS files), and you should have all of your midwater trawl files (operations, catches, lengths, and age-length keys). Above this subdirectory should be an overarching directory (<code>refdir</code>) that contains a reference csv file (<code>refcsv</code>).</p>
<ul>
<li><code>refdir</code>
<ul>
<li><code>refcsv</code>.csv</li>
<li><code>subdir</code> (e.g., H13)
<ul>
<li><code>svsubdir</code>
<ul>
<li>x.csv</li>
<li>y.csv</li>
<li>z.csv</li>
</ul></li>
<li><code>tssubdir</code>
<ul>
<li>x.csv</li>
<li>y.csv</li>
<li>z.csv</li>
</ul></li>
<li><code>optropf</code>.csv</li>
<li><code>trcatchf</code>.csv</li>
<li><code>trlff</code>.csv</li>
<li><code>keyfile1</code>.csv</li>
<li><code>keyfile2</code>.csv</li>
</ul></li>
<li><code>subdir</code> (e.g., H14)
<ul>
<li><code>svsubdir</code>
<ul>
<li>x.csv</li>
<li>y.csv</li>
<li>z.csv</li>
</ul></li>
<li><code>tssubdir</code>
<ul>
<li>x.csv</li>
<li>y.csv</li>
<li>z.csv</li>
</ul></li>
<li><code>optropf</code>.csv</li>
<li><code>trcatchf</code>.csv</li>
<li><code>trlff</code>.csv</li>
<li><code>keyfile1</code>.csv</li>
<li><code>keyfile2</code>.csv</li>
</ul></li>
<li><code>subdir</code> …</li>
</ul></li>
</ul>
</div>
<div id="reference-file" class="section level2">
<h2>Reference file</h2>
<p>The reference csv file contains information, primarily the directory and file names for the acoustic and midwater trawl data, for all of the subdirectories (one row for each subdirectory). The file must contain these 10 columns:</p>
<ul>
<li><code>subdir</code> = a subdirectory of <code>refdir</code> containing all the other subdirectories and files,<br />
</li>
<li><code>svsubdir</code> = the Sv subdirectory,<br />
</li>
<li><code>tssubdir</code> = the TS subdirectory,<br />
</li>
<li><code>optropf</code> = the midwater trawl operations file,<br />
</li>
<li><code>trcatchf</code> = the midwater trawl catch file,<br />
</li>
<li><code>trlff</code> = the midwater trawl lengths file,<br />
</li>
<li><code>keysp1</code> = the species code for keyfile1,<br />
</li>
<li><code>keyfile1</code> = the age-length csv file for specieskeysp1,<br />
</li>
<li><code>keysp2</code> = the species code for keyfile2, and<br />
</li>
<li><code>keyfile2</code> = the age-length csv file for specieskeysp2.</li>
</ul>
<p>There should also be one or more additional columns for <code>keyvars</code>, the key variable(s) used to define each unique run of the exploration and estimation process. In the example below, <code>LAKE</code> and <code>YEAR</code> are used as the key variables.</p>
<table>
<colgroup>
<col width="4%"></col>
<col width="4%"></col>
<col width="6%"></col>
<col width="8%"></col>
<col width="8%"></col>
<col width="10%"></col>
<col width="9%"></col>
<col width="9%"></col>
<col width="6%"></col>
<col width="12%"></col>
<col width="6%"></col>
<col width="8%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="right">LAKE</th>
<th align="right">YEAR</th>
<th align="left">subdir</th>
<th align="left">svsubdir</th>
<th align="left">tssubdir</th>
<th align="left">optropf</th>
<th align="left">trcatchf</th>
<th align="left">trlff</th>
<th align="right">keysp1</th>
<th align="left">keyfile1</th>
<th align="left">keysp2</th>
<th align="left">keyfile2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">3</td>
<td align="right">2013</td>
<td align="left">H13</td>
<td align="left">SV</td>
<td align="left">TS</td>
<td align="left">H.mtr.op13</td>
<td align="left">H.catch13</td>
<td align="left">Htr_lf13</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">2014</td>
<td align="left">H14</td>
<td align="left">SV</td>
<td align="left">TS</td>
<td align="left">H.mtr.op14</td>
<td align="left">H.catch14</td>
<td align="left">H.tr_lf14</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">2014</td>
<td align="left">M14</td>
<td align="left">SV</td>
<td align="left">TS</td>
<td align="left">MtrawlOp</td>
<td align="left">M.catch</td>
<td align="left">M.tr_lf</td>
<td align="right">106</td>
<td align="left">aleagelenkey</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="acoustic-files" class="section level2">
<h2>Acoustic files</h2>
<p>Except where noted, the order of the rows and columns in any of the acoustic or midwater trawl files is not important. Additional columns, i.e., other than those that are required, may be included in the files, but are not necessary.</p>
<p>In both the <strong>SV and TS</strong> csv files, the first column is automatically assigned the name <em>Dummy_ID</em>. This name write-over is needed to handle occasional problems with byte order marks at the beginning of the csv files. The variable <em>Dummy_ID</em> is not actually used in the exploration or estimation procedures.</p>
<p>The following 8 columns must be included in both the <strong>SV and TS</strong> csv files:</p>
<ul>
<li>Dummy_ID = dummy variable not used at all, must be the <strong>FIRST COLUMN</strong></li>
<li>Region_name = transect name, composed of region (the first two characters) and transect ID number (the following characters)</li>
<li>Interval = interval ID numbers, identifying acoustic transect segments</li>
<li>Layer = layer ID numbers, identifying 10-m acoustic layers in the water column, numbered from the surface to the bottom</li>
<li>Layer_depth_min = minimum of corresponding depth layer in m</li>
<li>Layer_depth_max = maximum of corresponding depth layer in m</li>
<li>Lat_M = latitude in decimal degrees</li>
<li>Lon_M = longitude in decimal degrees</li>
</ul>
<p>These columns serve to uniquely identify each row in the files, and are used to combine the information from both types of files.</p>
<p>The following 4 columns must be included in the <strong>SV</strong> csv files:</p>
<ul>
<li>Date_M = date, YYYYMMDD</li>
<li>Sv_mean = mean volume backscattering strength in dB</li>
<li>Depth_mean = range to target in m</li>
<li>PRC_ABC = area backscattering coefficient (unitless)</li>
</ul>
<table>
<colgroup>
<col width="7%"></col>
<col width="10%"></col>
<col width="7%"></col>
<col width="5%"></col>
<col width="7%"></col>
<col width="6%"></col>
<col width="9%"></col>
<col width="13%"></col>
<col width="13%"></col>
<col width="5%"></col>
<col width="5%"></col>
<col width="7%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="right">Dummy_ID</th>
<th align="left">Region_name</th>
<th align="right">Interval</th>
<th align="right">Layer</th>
<th align="left">Date_M</th>
<th align="right">Sv_mean</th>
<th align="right">Depth_mean</th>
<th align="right">Layer_depth_min</th>
<th align="right">Layer_depth_max</th>
<th align="right">Lat_M</th>
<th align="right">Lon_M</th>
<th align="left">PRC_ABC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">no6</td>
<td align="right">4</td>
<td align="right">14</td>
<td align="left">20140807</td>
<td align="right">-102.8</td>
<td align="right">135.0</td>
<td align="right">130</td>
<td align="right">140</td>
<td align="right">45.36</td>
<td align="right">-86.28</td>
<td align="left">5.26e-10</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">no6</td>
<td align="right">9</td>
<td align="right">16</td>
<td align="left">20140807</td>
<td align="right">-78.0</td>
<td align="right">154.9</td>
<td align="right">150</td>
<td align="right">160</td>
<td align="right">45.36</td>
<td align="right">-86.45</td>
<td align="left">1.56e-07</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">no2</td>
<td align="right">2</td>
<td align="right">12</td>
<td align="left">20140807</td>
<td align="right">-96.2</td>
<td align="right">115.0</td>
<td align="right">110</td>
<td align="right">120</td>
<td align="right">44.08</td>
<td align="right">-86.86</td>
<td align="left">2.42e-09</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">no4</td>
<td align="right">3</td>
<td align="right">8</td>
<td align="left">20140806</td>
<td align="right">-95.9</td>
<td align="right">75.0</td>
<td align="right">70</td>
<td align="right">80</td>
<td align="right">44.72</td>
<td align="right">-86.54</td>
<td align="left">2.60e-09</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">nn9</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="left">20140819</td>
<td align="right">-84.3</td>
<td align="right">25.0</td>
<td align="right">20</td>
<td align="right">30</td>
<td align="right">45.07</td>
<td align="right">-86.92</td>
<td align="left">3.70e-08</td>
</tr>
</tbody>
</table>
<p>Several columns must be included in the <strong>TS</strong> csv files indicating the number of targets in each target strength bin. Each target count columns is named according to the integer target strength, with an <em>X.</em> prefix, e.g.:</p>
<ul>
<li>X.16</li>
<li>X.17</li>
<li>…</li>
<li>X.75</li>
<li>X.76</li>
</ul>
<table style="width:100%;">
<colgroup>
<col width="7%"></col>
<col width="10%"></col>
<col width="7%"></col>
<col width="5%"></col>
<col width="13%"></col>
<col width="13%"></col>
<col width="7%"></col>
<col width="8%"></col>
<col width="4%"></col>
<col width="4%"></col>
<col width="4%"></col>
<col width="4%"></col>
<col width="4%"></col>
<col width="4%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="right">Dummy_ID</th>
<th align="left">Region_name</th>
<th align="right">Interval</th>
<th align="right">Layer</th>
<th align="right">Layer_depth_min</th>
<th align="right">Layer_depth_max</th>
<th align="right">Lat_M</th>
<th align="right">Lon_M</th>
<th align="right">X.36</th>
<th align="right">X.37</th>
<th align="right">X.38</th>
<th align="right">X.64</th>
<th align="right">X.65</th>
<th align="right">X.66</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">no3</td>
<td align="right">2</td>
<td align="right">15</td>
<td align="right">140</td>
<td align="right">150</td>
<td align="right">44.39679</td>
<td align="right">-87.07275</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">13</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">no1</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">20</td>
<td align="right">30</td>
<td align="right">43.74271</td>
<td align="right">-87.32775</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">nn1</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">50</td>
<td align="right">60</td>
<td align="right">43.78454</td>
<td align="right">-86.58780</td>
<td align="right">4</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">no4</td>
<td align="right">6</td>
<td align="right">5</td>
<td align="right">40</td>
<td align="right">50</td>
<td align="right">44.71496</td>
<td align="right">-86.42347</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">no6</td>
<td align="right">6</td>
<td align="right">7</td>
<td align="right">60</td>
<td align="right">70</td>
<td align="right">45.36183</td>
<td align="right">-86.35453</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="midwater-trawl-files" class="section level2">
<h2>Midwater trawl files</h2>
<p>The following 1 column must be included in the midwater trawl <strong>operation</strong>, <strong>catch</strong>, and <strong>length</strong> csv files:</p>
<ul>
<li>Op.Id = operation ID number</li>
</ul>
<p>This column serves to uniquely identify each trawl haul in the files.</p>
<p>The following 9 columns must be included in the midwater trawl <strong>operation</strong> csv files:</p>
<ul>
<li>Year = year</li>
<li>Lake = lake ID code</li>
<li>Beg.Depth = bottom depth at beginning of trawl haul in m</li>
<li>End.Depth = bottom depth at end of trawl haul in m</li>
<li>Fishing_Depth = fishing depth of trawl haul in m</li>
<li>Transect = transect name, composed of region (the first two characters) and transect ID number (the following characters), the same as Region_name in the SV and TS files</li>
<li>Latitude = latitude in decimal degrees</li>
<li>Longitude = longitude in decimal degrees</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="right">Op.Id</th>
<th align="right">Year</th>
<th align="right">Lake</th>
<th align="right">Beg.Depth</th>
<th align="right">End.Depth</th>
<th align="right">Fishing_Depth</th>
<th align="left">Transect</th>
<th align="right">Latitude</th>
<th align="right">Longitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">89426</td>
<td align="right">2014</td>
<td align="right">2</td>
<td align="right">23.0</td>
<td align="right">27.4</td>
<td align="right">1.8</td>
<td align="left">nn7</td>
<td align="right">45.86</td>
<td align="right">-86.09</td>
</tr>
<tr class="even">
<td align="right">89421</td>
<td align="right">2014</td>
<td align="right">2</td>
<td align="right">50.0</td>
<td align="right">46.0</td>
<td align="right">10.0</td>
<td align="left">sn4</td>
<td align="right">42.76</td>
<td align="right">-86.32</td>
</tr>
<tr class="odd">
<td align="right">89419</td>
<td align="right">2014</td>
<td align="right">2</td>
<td align="right">58.0</td>
<td align="right">52.0</td>
<td align="right">45.0</td>
<td align="left">sn2</td>
<td align="right">42.11</td>
<td align="right">-86.69</td>
</tr>
<tr class="even">
<td align="right">88608</td>
<td align="right">2014</td>
<td align="right">2</td>
<td align="right">29.3</td>
<td align="right">24.1</td>
<td align="right">6.0</td>
<td align="left">wn1</td>
<td align="right">42.16</td>
<td align="right">-87.59</td>
</tr>
<tr class="odd">
<td align="right">88617</td>
<td align="right">2014</td>
<td align="right">2</td>
<td align="right">111.9</td>
<td align="right">116.1</td>
<td align="right">60.0</td>
<td align="left">so0</td>
<td align="right">42.34</td>
<td align="right">-87.28</td>
</tr>
</tbody>
</table>
<p>The following 3 columns must be included in the midwater trawl <strong>catch</strong> csv files:</p>
<ul>
<li>Species = species code</li>
<li>Weight = aggregate weight in g</li>
<li>N = number of fish weighed</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="right">Op.Id</th>
<th align="right">Species</th>
<th align="right">Weight</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">89414</td>
<td align="right">204</td>
<td align="right">3544.7</td>
<td align="right">65</td>
</tr>
<tr class="even">
<td align="right">89428</td>
<td align="right">204</td>
<td align="right">604.0</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">89425</td>
<td align="right">109</td>
<td align="right">24.8</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">89421</td>
<td align="right">106</td>
<td align="right">342.1</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="right">89415</td>
<td align="right">106</td>
<td align="right">4.2</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<p>The following 3 columns must be included in the midwater trawl <strong>length</strong> csv files:</p>
<ul>
<li>Species = species code</li>
<li>Length = length of individual fish in mm</li>
<li>N = number of fish measured</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="right">Op.Id</th>
<th align="right">Species</th>
<th align="right">Length</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">89429</td>
<td align="right">106</td>
<td align="right">170</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">89424</td>
<td align="right">106</td>
<td align="right">161</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">88649</td>
<td align="right">106</td>
<td align="right">162</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">89426</td>
<td align="right">106</td>
<td align="right">173</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">89426</td>
<td align="right">106</td>
<td align="right">149</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Note that the number of fish measured (N in the <strong>length</strong> csv file) need not be the same as the total number captured (N in the <strong>catch</strong> csv file). All proportions based on size are calculated by first scaling up the measured fish to the total catch, to account for those instances when only a subset of the catch is measured.</p>
</div>
<div id="age-length-key-files" class="section level2">
<h2>Age-length key files</h2>
<p>No age-length key is required, but you may include age-length keys in separate csv files for up to 2 different species. Each file should be arranged such that rows represent 10-mm length categories and columns represent 1-yr ages. The file must contain one variable called <em>mmgroup</em> giving the midpoint of the length category, e.g., <em>mmgroup</em> 15 represents fish <span class="math inline">\(\geq\)</span> 10 mm and &lt; 20 mm. For each length category, the proportion of fish in each age is represented by a series of columns which sum to 1 (or 0, if no fish used to derive the key were found that length category). Each proportional column is named according to the integer age, with an <em>Age</em> prefix, e.g.:</p>
<ul>
<li>mmgroup = midpoint of 10-mm length category</li>
<li>Age0 = proportion of all fish in corresponding length category that are age 0</li>
<li>Age1 = proportion … that are age 1</li>
<li>…</li>
<li>Age8 = proportion … that are age 8</li>
<li>Age9 = proportion … that are age 9</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="right">mmgroup</th>
<th align="right">Age0</th>
<th align="right">Age1</th>
<th align="right">Age2</th>
<th align="right">Age3</th>
<th align="right">Age4</th>
<th align="right">Age5</th>
<th align="right">Age6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">95</td>
<td align="right">1</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">105</td>
<td align="right">0</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">115</td>
<td align="right">0</td>
<td align="right">0.500</td>
<td align="right">0.500</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">125</td>
<td align="right">0</td>
<td align="right">0.133</td>
<td align="right">0.800</td>
<td align="right">0.000</td>
<td align="right">0.067</td>
<td align="right">0.000</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">135</td>
<td align="right">0</td>
<td align="right">0.145</td>
<td align="right">0.527</td>
<td align="right">0.273</td>
<td align="right">0.036</td>
<td align="right">0.018</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="read-in-the-data" class="section level1">
<h1>Read in the data</h1>
<p>With the data organized as described and the reference file as a guide to the directory and file names, you can now read in the acoustic and midwater trawl data using the <code>readAll()</code> function.</p>
<p>In the example below, the overarching directory <code>refdir</code> is <em>C:/Temp</em> (use forward slashes for paths), and the reference file <code>refcsv</code> is <em>Reference.csv</em>. Only data from the 3rd row of the reference file will be read, specified by <code>keyvals</code> for the <code>keyvars</code>, i.e., <code>LAKE==2</code> and <code>YEAR==2014</code>. The data are saved to an RData file <code>rdat</code> named <em>ACMT</em>, and the subdirectory path is returned.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>mydir &lt;-<span class="st"> </span><span class="kw">readAll</span>(<span class="dt">refdir=</span><span class="st">&quot;C:/Temp&quot;</span>, <span class="dt">keyvals=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2014</span>), </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="dt">keyvars=</span><span class="kw">c</span>(<span class="st">&quot;LAKE&quot;</span>, <span class="st">&quot;YEAR&quot;</span>), <span class="dt">rdat=</span><span class="st">&quot;ACMT&quot;</span>, <span class="dt">refcsv=</span><span class="st">&quot;Reference&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>mydir</span></code></pre></div>
<pre><code>## [1] &quot;C:/Temp/M14/&quot;</code></pre>
</div>
<div id="explore-the-data" class="section level1">
<h1>Explore the data</h1>
<p>Now you’re ready to explore the data with the <code>exploreACMT()</code> or <code>exploreACMT2()</code> function. The <code>exploreACMT()</code> function was designed specifically for use with data from the <a href="https://www.glsc.usgs.gov/">US Geological Survey - Great Lakes Science Center</a>. The <code>exploreACMT2()</code> function is a simplified version that does not expect the additional columns the USGS data contains; use this one if in doubt.</p>
<p>The <code>AC</code> and <code>MT</code> arguments are used to indicate if you want to explore the AC and MT data. The <code>ageSp</code> argument gives the species codes for species that you want to apply age-length keys to; in this example <code>ageSp=106</code> for alewife. The <code>short</code> argument is used to indicate if the surveyed area is wider (in the east-west direction) than tall (in the north-south direction); in this example <code>short=FALSE</code> because Lake Michigan is not wider than tall.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">exploreACMT</span>(<span class="dt">maindir=</span>mydir, <span class="dt">rdat=</span><span class="st">&quot;ACMT&quot;</span>, <span class="dt">AC=</span><span class="ot">TRUE</span>, <span class="dt">MT=</span><span class="ot">TRUE</span>, <span class="dt">ageSp=</span><span class="dv">106</span>, <span class="dt">short=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p>When you run this function, a rich text file (rtf) with a *.doc file extension (so that it will be opened with Word by default) is saved to <code>maindir</code>. It includes a long series of tables and figures summarizing the variables in the acoustic and midwater trawl data files. These are designed to help the investigator look for potential problems in the data.</p>
</div>
<div id="generate-estimates" class="section level1">
<h1>Generate estimates</h1>
<p>Once you’ve error checked the data and are confident that they are in good shape, you are ready to generate lake-wide estimates.</p>
<div id="regions" class="section level2">
<h2>Regions</h2>
<p>Define the <em>strata</em> used to design the survey. These are assumed to be non-overlapping two-dimensional regions that correspond to <code>Region_name</code> in the SV and TS files and <code>Transect</code> in the midwater trawl operation file. Also supply the surface areas (in ha) that correspond to each stratum. If you did not use strata in the design of your survey, just use a single region.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>Mreg &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;nn&quot;</span>, <span class="st">&quot;sn&quot;</span>, <span class="st">&quot;wn&quot;</span>, <span class="st">&quot;no&quot;</span>, <span class="st">&quot;so&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>MArea &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10933</span>, <span class="dv">8716</span>, <span class="dv">6010</span>, <span class="dv">12630</span>, <span class="dv">10487</span>)</span></code></pre></div>
</div>
<div id="size-information" class="section level2">
<h2>Size information</h2>
<p>Create a data frame of species-specific size information for each species group for which you wish to generate abundance estimates. The data frame has five variables: <code>sp</code> species code, <code>spname</code> species name, <code>lcut</code> length cut off (in mm), <code>lwa</code> and <code>lwb</code> parameters of the length-weight relation, <span class="math inline">\(Wg = lwa*Lmm^{lwb}\)</span>, where <em>Wg</em> is the weight (in g) and <em>Lmm</em> is the total length (in mm). The length cut off is used to divide the data for a given species into two groups for abundance estimation, those with fish lengths <span class="math inline">\(\leq\)</span> <code>lcut</code> and &gt; <code>lcut</code>) for estimation. If you don’t wish to divide a species into two length groups, set <code>lcut</code> to 0 for that species. This will be used as input to the <code>estimateLake()</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>myspInfo &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="dt">sp =</span> <span class="kw">c</span>(<span class="dv">106</span>, <span class="dv">109</span>, <span class="dv">129</span>),</span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="dt">spname =</span> <span class="kw">c</span>(<span class="st">&quot;alewife&quot;</span>, <span class="st">&quot;rainbow smelt&quot;</span>, <span class="st">&quot;threespine stickleback&quot;</span>),</span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="dt">lcut =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">90</span>, <span class="dv">0</span>),</span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="dt">lwa =</span> <span class="kw">c</span>(<span class="fl">1.41e-05</span>, <span class="fl">4.85e-06</span>, <span class="fl">3.95e-05</span>),</span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="dt">lwb =</span> <span class="kw">c</span>(<span class="fl">2.87</span>, <span class="fl">3.03</span>, <span class="fl">2.59</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a>)</span></code></pre></div>
</div>
<div id="slices" class="section level2">
<h2>Slices</h2>
<p>The fish density in acoustic cell (interval-layer) is apportioned to species using the composition from the nearest midwater trawl within a given <em>slice</em>. Slices are not necessarily the same as <em>strata</em>, which are used in the design of the survey and the estimation of the total population.</p>
<p>The slices can be defined by combinations of fishing depths (<code>fdp</code>), bottom depths (<code>bdp</code>), longitudes (<code>lon</code>), latitudes (<code>lat</code>), and regions (<code>reg</code>). The slice definition is described by a list of slices; each slice is a list of defining characteristics; and each characteristic is a named vector giving the range of values. This will be used as input to the <code>sliceCat()</code> function.</p>
<p>This is easier to explain with some examples. Let’s say you want to define two slices, based on a dividing line at a fishing depth of 20 m. You would write your slice definition as</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>myslice1 &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="dt">epi  =</span> <span class="kw">list</span>(<span class="dt">fdp=</span><span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>,  <span class="dv">20</span>)),</span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="dt">hypo =</span> <span class="kw">list</span>(<span class="dt">fdp=</span><span class="kw">c</span>(  <span class="dv">20</span>, <span class="ot">Inf</span>))</span>
<span id="cb9-4"><a href="#cb9-4"></a>  )</span></code></pre></div>
<p>This names the upper slice <em>“epi”</em> and the lower slice <em>“hypo”</em> (you can name the slices whatever you want, but they must be named). And it defines these slices by the corresponding range of fishing depths (<code>fdp</code>), from <span class="math inline">\(\geq\)</span> negative infinity to &lt; 20 for <em>epi</em> and from <span class="math inline">\(\geq\)</span> 20 to &lt; positive infinity for <em>hypo</em>.</p>
<p>Or, perhaps you want to define four slices, using the same premise as before, but now dividing the epilimnion into three parts according to latitude. You might write your slice definition as</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>myslice2 &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="dt">epi.south   =</span> <span class="kw">list</span>(<span class="dt">fdp=</span><span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>,  <span class="dv">20</span>), <span class="dt">lat=</span><span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>,  <span class="dv">43</span>)),</span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="dt">epi.central =</span> <span class="kw">list</span>(<span class="dt">fdp=</span><span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>,  <span class="dv">20</span>), <span class="dt">lat=</span><span class="kw">c</span>(  <span class="dv">43</span>,  <span class="dv">45</span>)),</span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="dt">epi.north   =</span> <span class="kw">list</span>(<span class="dt">fdp=</span><span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>,  <span class="dv">20</span>), <span class="dt">lat=</span><span class="kw">c</span>(  <span class="dv">45</span>, <span class="ot">Inf</span>)),</span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="dt">hypo        =</span> <span class="kw">list</span>(<span class="dt">fdp=</span><span class="kw">c</span>(  <span class="dv">20</span>, <span class="ot">Inf</span>))</span>
<span id="cb10-6"><a href="#cb10-6"></a>  )</span></code></pre></div>
<p>Similarly, slices may also be defined by ranges of bottom depths and longitudes. If you wish to define slices by regions that are not simply described by longitudinal or latitudinal breakpoints, for example separating the bays from the main basin, you might write your slice definition as</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>myslice3 &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="dt">epi.bays =</span> <span class="kw">list</span>(<span class="dt">fdp=</span><span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>,  <span class="dv">20</span>), <span class="dt">reg=</span><span class="kw">c</span>(<span class="st">&quot;Bay A&quot;</span>, <span class="st">&quot;Bay B&quot;</span>)),</span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="dt">epi.main =</span> <span class="kw">list</span>(<span class="dt">fdp=</span><span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>,  <span class="dv">20</span>), <span class="dt">reg=</span><span class="st">&quot;Main&quot;</span>),</span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="dt">hypo     =</span> <span class="kw">list</span>(<span class="dt">fdp=</span><span class="kw">c</span>(  <span class="dv">20</span>, <span class="ot">Inf</span>))</span>
<span id="cb11-5"><a href="#cb11-5"></a>  )</span></code></pre></div>
<p>I’ll provide some fake data to demonstrate how these slice definitions compare.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>fishingD &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">10</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">26</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>latitude &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">42</span>, <span class="dv">44</span>, <span class="dv">44</span>, <span class="dv">46</span>, <span class="dv">47</span>, <span class="dv">46</span>, <span class="fl">46.1</span>, <span class="dv">66</span>, <span class="fl">43.2</span>, <span class="dv">41</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>region &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Bay A&quot;</span>, <span class="st">&quot;Bay B&quot;</span>, <span class="st">&quot;Main&quot;</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)]</span>
<span id="cb12-4"><a href="#cb12-4"></a>s1 &lt;-<span class="st"> </span><span class="kw">sliceCat</span>(myslice1, <span class="dt">fdp=</span>fishingD)</span>
<span id="cb12-5"><a href="#cb12-5"></a>s2 &lt;-<span class="st"> </span><span class="kw">sliceCat</span>(myslice2, <span class="dt">fdp=</span>fishingD, <span class="dt">lat=</span>latitude)</span>
<span id="cb12-6"><a href="#cb12-6"></a>s3 &lt;-<span class="st"> </span><span class="kw">sliceCat</span>(myslice3, <span class="dt">fdp=</span>fishingD, <span class="dt">reg=</span>region)</span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="kw">data.frame</span>(fishingD, latitude, region, s1, s2, s3)</span></code></pre></div>
<pre><code>##    fishingD latitude region   s1          s2       s3
## 1        13     42.0   Main  epi   epi.south epi.main
## 2        10     44.0  Bay A  epi epi.central epi.bays
## 3        17     44.0   Main  epi epi.central epi.main
## 4        15     46.0  Bay B  epi   epi.north epi.bays
## 5        18     47.0   Main  epi   epi.north epi.main
## 6        22     46.0  Bay A hypo        hypo     hypo
## 7        21     46.1  Bay B hypo        hypo     hypo
## 8        25     66.0   Main hypo        hypo     hypo
## 9        24     43.2   Main hypo        hypo     hypo
## 10       26     41.0   Main hypo        hypo     hypo</code></pre>
</div>
<div id="estimates" class="section level2">
<h2>Estimates</h2>
<p>Now you’re ready to use the <code>estimateLake()</code> function to generate lake-wide estimates in both number (millions) and biomass (t). The <code>region</code> and <code>regArea</code> arguments are used to indicate the regional strata and their corresponding areas (in ha). The <code>TSrange</code> is the target strength range of interest. The <code>TSthresh</code> is the minimum threshold for the number of binned targets in a cell (layer by interval) for calculating target strength. The <code>psi</code> is the transducer-specific two-way equivalent beam angle in steradians. Species of interest are specified by <code>soi</code>, and each of these species should have size information in the data frame specified by <code>spInfo</code>. The slice definitions by which the estimates should be summarized are specified by the <code>sliceDef</code> argument. Finally, the <code>descr</code> argument is used to add a little descriptive text to the names of the output files.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">estimateLake</span>(<span class="dt">maindir=</span>mydir, <span class="dt">rdat=</span><span class="st">&quot;ACMT&quot;</span>, <span class="dt">ageSp=</span><span class="dv">106</span>, <span class="dt">region=</span>Mreg, <span class="dt">regArea=</span>MArea,</span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="dt">TSrange=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>, <span class="dv">-30</span>), <span class="dt">TSthresh=</span><span class="dv">1</span>, <span class="dt">psi=</span><span class="fl">0.007997566</span>, <span class="dt">soi=</span><span class="kw">c</span>(<span class="dv">106</span>, <span class="dv">109</span>, <span class="dv">129</span>),</span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="dt">spInfo=</span>myspInfo, <span class="dt">sliceDef=</span>myslice1, <span class="dt">short=</span><span class="ot">FALSE</span>, <span class="dt">descr=</span><span class="st">&quot;vignette&quot;</span>)</span></code></pre></div>
<p>When you run this function, a rich text file (rtf) with a *.doc file extension (so that it will be opened with Word by default) is saved to <code>maindir</code>. The document includes figures showing the location and apportionment of midwater trawl hauls in the slices and spatial maps of density for each species group, as well as tables of the lake-wide estimates in both number (millions) and biomass (t) for each species group and slice.</p>
<p>In addition, six different data frames of estimates are saved as objects in an RData file and are written to csv files:</p>
<ul>
<li><code>Lakes</code> = lake-wide totals (in millions and t) and means (in numbers and g per ha), with a row for each species group and estimate type and columns for estimates, standard errors, and relative standard errors.</li>
<li><code>Regions</code> = region means (in fish per ha and g per ha), with a row for each region, species group, and estimate type and columns for estimates and corresponding (surface) areas.</li>
<li><code>intmeans_nph</code> = interval means (in fish per ha), with a row for each region and interval, a column for each species group, and additional columns for region area, and the interval bottom depth, latitude and longitude.</li>
<li><code>intmeans_gph</code> = interval means (in g per ha), similar to <code>intmeans_nph</code>.</li>
<li><code>intlaymeans_nph</code> = interval and layer means (in fish per ha), with a row for each region, interval, and layer, a column for each species group, and many additional columns.</li>
<li><code>intlaymeans_gph</code> = interval and layer means (in g per ha), similar to <code>intlaymeans_nph</code>.</li>
</ul>
<p>The rtf, RData, and csv files are all named using the lake, the year, and the <code>descr</code> text.</p>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>Below is a summary of the code used in this vignette, simplified somewhat by relying on default values wherever possible.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">library</span>(EchoNet2Fish)</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># read in the data</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>mydir &lt;-<span class="st"> </span><span class="kw">readAll</span>(<span class="dt">refdir=</span><span class="st">&quot;C:/Temp&quot;</span>, <span class="dt">keyvals=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2014</span>))</span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co"># explore the data</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="kw">exploreACMT</span>(<span class="dt">maindir=</span>mydir, <span class="dt">ageSp=</span><span class="dv">106</span>, <span class="dt">short=</span><span class="ot">FALSE</span>)</span>
<span id="cb15-8"><a href="#cb15-8"></a></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co"># define survey strata</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>Mreg &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;nn&quot;</span>, <span class="st">&quot;sn&quot;</span>, <span class="st">&quot;wn&quot;</span>, <span class="st">&quot;no&quot;</span>, <span class="st">&quot;so&quot;</span>)</span>
<span id="cb15-11"><a href="#cb15-11"></a>MArea &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10933</span>, <span class="dv">8716</span>, <span class="dv">6010</span>, <span class="dv">12630</span>, <span class="dv">10487</span>)</span>
<span id="cb15-12"><a href="#cb15-12"></a></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co"># define species size info</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>myspInfo &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb15-15"><a href="#cb15-15"></a>  <span class="dt">sp =</span> <span class="kw">c</span>(<span class="dv">106</span>, <span class="dv">109</span>, <span class="dv">129</span>),</span>
<span id="cb15-16"><a href="#cb15-16"></a>  <span class="dt">spname =</span> <span class="kw">c</span>(<span class="st">&quot;alewife&quot;</span>, <span class="st">&quot;rainbow smelt&quot;</span>, <span class="st">&quot;threespine stickleback&quot;</span>),</span>
<span id="cb15-17"><a href="#cb15-17"></a>  <span class="dt">lcut =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">90</span>, <span class="dv">0</span>),</span>
<span id="cb15-18"><a href="#cb15-18"></a>  <span class="dt">lwa =</span> <span class="kw">c</span>(<span class="fl">1.41e-05</span>, <span class="fl">4.85e-06</span>, <span class="fl">3.95e-05</span>),</span>
<span id="cb15-19"><a href="#cb15-19"></a>  <span class="dt">lwb =</span> <span class="kw">c</span>(<span class="fl">2.87</span>, <span class="fl">3.03</span>, <span class="fl">2.59</span>)</span>
<span id="cb15-20"><a href="#cb15-20"></a>)</span>
<span id="cb15-21"><a href="#cb15-21"></a></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="co"># define summary slices</span></span>
<span id="cb15-23"><a href="#cb15-23"></a>myslice1 &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb15-24"><a href="#cb15-24"></a>  <span class="dt">epi  =</span> <span class="kw">list</span>(<span class="dt">fdp=</span><span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>,  <span class="dv">20</span>)),</span>
<span id="cb15-25"><a href="#cb15-25"></a>  <span class="dt">hypo =</span> <span class="kw">list</span>(<span class="dt">fdp=</span><span class="kw">c</span>(  <span class="dv">20</span>, <span class="ot">Inf</span>))</span>
<span id="cb15-26"><a href="#cb15-26"></a>  )</span>
<span id="cb15-27"><a href="#cb15-27"></a></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="co"># generate estimates</span></span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="kw">estimateLake</span>(<span class="dt">maindir=</span>mydir, <span class="dt">ageSp=</span><span class="dv">106</span>, <span class="dt">region=</span>Mreg, <span class="dt">regArea=</span>MArea,</span>
<span id="cb15-30"><a href="#cb15-30"></a>  <span class="dt">soi=</span><span class="kw">c</span>(<span class="dv">106</span>, <span class="dv">109</span>, <span class="dv">129</span>), <span class="dt">spInfo=</span>myspInfo, <span class="dt">sliceDef=</span>myslice1, <span class="dt">short=</span><span class="ot">FALSE</span>, <span class="dt">descr=</span><span class="st">&quot;vignette&quot;</span>)</span></code></pre></div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Parker-Stetter, S. L., Rudstam, L. G., Sullivan, P. J., and Warner, D. M. 2009. Standard operating procedures for fisheries acoustic surveys in the Great Lakes. Great Lakes Fish. Comm. Spec. Pub. 09-01. <a href="http://www.glfc.org/pubs/SpecialPubs/Sp09_1.pdf">www.glfc.org/pubs/SpecialPubs/Sp09_1.pdf</a>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
